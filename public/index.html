<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Everybody's News — Breaking Stories</title>
  <link rel="stylesheet" href="rex-carousel-adjustments.css">
  <style id="fallback-css">
    /* TEMP fallback so the page renders even if external CSS isn't picked up */
    :root{--keyline:rgba(0,0,0,.08)}

    html,body{margin:0;padding:0;background:#fff;color:#111;font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
    body{display:block !important;visibility:visible !important;opacity:1 !important}
    .container,.bkwrapper{max-width:1200px;margin:0 auto;padding:0 16px}
    header.rex-header{position:sticky;top:0;background:#fff;border-bottom:1px solid var(--keyline);z-index:10}
    .rex-nav{display:flex;align-items:center;justify-content:space-between;gap:16px;padding:14px 0}
    .rex-menu{display:flex;gap:20px;list-style:none;margin:0;padding:0}
    .rex-menu a{text-decoration:none;color:#111;font-size:14px}

    /* Rex Hero */
    #rex-hero .rex-hero-block{min-height:280px;background:#0f172a;color:#fff;display:flex;align-items:flex-end;padding:32px;border-bottom:1px solid var(--keyline)}
    .rex-hero-headline{margin:0;font-weight:800;font-size:36px}


    /* Under-hero feature */
    #rex-underhero{margin:28px auto}
    .rex-feature-grid{display:grid;grid-template-columns:2fr 1.1fr;gap:24px}
    .rex-media-aspect{position:relative;border:1px solid var(--keyline);border-radius:12px;overflow:hidden;background:#000}
    .rex-media-aspect:before{content:"";display:block;aspect-ratio:16/9}
    .rex-caption{position:absolute;left:16px;right:16px;bottom:16px;color:#fff}
    .rex-side-list{display:flex;flex-direction:column;gap:12px}
    .rex-side-item{border:1px solid var(--keyline);border-radius:8px;padding:12px}

    /* Sport module */
    #rex-sport{margin:36px auto}
    #rex-sport .row{display:grid;grid-template-columns:1.35fr 1fr;gap:24px}
    #rex-sport .thumb{height:280px;background:#e5e7eb;border:1px solid var(--keyline);border-radius:12px}
    #rex-sport .bk-calendar-meta{margin-top:-260px;margin-left:12px;background:#000a;color:#fff;padding:8px 10px;border-radius:6px;width:56px;text-align:center}
    #rex-sport .list-small-post{list-style:none;margin:0;padding:0;border-top:1px solid var(--keyline)}
    #rex-sport .list-small-post li{display:grid;grid-template-columns:1fr 120px;gap:12px;align-items:center;padding:14px 0;border-bottom:1px solid var(--keyline)}
    #rex-sport .list-small-post .thumb{height:72px;grid-column:2;background:#e5e7eb;border:1px solid var(--keyline);border-radius:6px}#rex-sport .list-small-post .title{grid-column:1} @media(max-width:680px){#rex-sport .list-small-post li{grid-template-columns:1fr 96px}#rex-sport .list-small-post .thumb{width:96px;height:64px}}

    /* Fashion grid */
    #rex-fashion-grid{margin:36px auto}
    .bk-square-grid-wrap{list-style:none;margin:0;padding:0;display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
    .bk-square-grid-wrap .thumb{aspect-ratio:1/1;background:#e5e7eb;border:1px solid var(--keyline);border-radius:8px}
    .bk-square-grid-wrap li{border:1px solid var(--keyline);border-radius:8px;padding:10px}

    /* Tech section + promo */
    #rex-tech{margin:36px auto}
    #rex-tech .row{display:grid;grid-template-columns:1.6fr 1fr .8fr;gap:24px}
    #rex-tech .large-post{border:1px solid var(--keyline);border-radius:12px;min-height:260px;display:flex;align-items:flex-end;padding:16px;background:linear-gradient(180deg,#dfe7f1 0,#ccd6e3 100%)}
    #rex-tech .col-list .list-small-post{list-style:none;margin:0;padding:0;border-top:1px solid var(--keyline); /* enforce subcat list structure */ }
    #rex-tech .col-list .list-small-post li{display:grid;grid-template-columns:1fr 120px;gap:16px;align-items:center;padding:12px 0;border-bottom:1px solid var(--keyline)} #rex-tech .col-list .list-small-post .post-c-wrap{grid-column:1} #rex-tech .col-list .list-small-post .thumb{grid-column:2;width:120px;height:80px;background:#e5e7eb;border:1px solid var(--keyline);border-radius:6px} @media(max-width:680px){#rex-tech .col-list .list-small-post li{grid-template-columns:1fr 96px}#rex-tech .col-list .list-small-post .thumb{width:96px;height:64px}}
    .tech-sidebar .promo-card{position:sticky;top:88px;border:1px solid var(--keyline);border-radius:12px;padding:16px;background:#fff}

    /* Utilities */
    .module-title h2{margin:0 0 16px;font-size:26px;font-weight:900;letter-spacing:.01em}
    .module-title .main-title h2 span{color:#111;text-transform:uppercase;font-size:.9em;letter-spacing:.08em}
    .module-title{display:flex;align-items:baseline;gap:12px;margin-bottom:12px}
    .module-title .sub-title{color:#666;font-size:14px}
    .title{margin:6px 0 0;font-size:16px}
    @media(max-width:1024px){
      .rex-feature-grid{grid-template-columns:1fr}
      #rex-sport .row{grid-template-columns:1fr}
      #rex-tech .row{grid-template-columns:1fr}
      .bk-square-grid-wrap{grid-template-columns:1fr 1fr}
    }
    @media(max-width:560px){.bk-square-grid-wrap{grid-template-columns:1fr}}
  </style>
  <style>
    /* --- Ensure consistent spacing for sections AFTER the New Carousel --- */
    #rex-home-carousel{margin:36px auto}
    /* *** CHANGE 3: Rex Carousel Height and Padding Adjustments *** */
    #rex-home-carousel{min-height:420px;padding:1.5rem 0}
    #rex-home-carousel .bk-carousel-wrap{padding:1rem}
    #rex-home-carousel .bk-carousel{gap:12px;display:flex;overflow-x:auto;scroll-behavior:smooth;list-style:none;margin:0;padding:0}
    #rex-home-carousel .bk-carousel > li{padding:0.75rem;min-width:300px;flex:0 0 auto}
    #rex-home-carousel .thumb{min-height:180px;width:100%;border-radius:8px;overflow:hidden;background:#e5e7eb;border:1px solid var(--keyline)}
    #rex-home-carousel .thumb img{width:100%;height:100%;object-fit:cover}
    #rex-home-carousel .post-c-wrap{padding:12px 0}
    #rex-home-carousel .title{font-size:16px;font-weight:700;line-height:1.3;margin:0}
    #rex-home-carousel .title a{color:#111;text-decoration:none}
    #rex-home-carousel .title a:hover{color:#d32f2f}
    #rex-home-carousel .meta{font-size:12px;color:#666;margin-top:8px;display:flex;align-items:center;gap:6px}
    #rex-home-carousel .source-icon{width:16px;height:16px;border-radius:4px;vertical-align:middle}
    @media(max-width:1024px){#rex-home-carousel{min-height:380px;padding:1.25rem 0}#rex-home-carousel .thumb{min-height:160px}}
    @media(max-width:768px){#rex-home-carousel{min-height:350px;padding:1rem 0}#rex-home-carousel .bk-carousel-wrap{padding:0.75rem}#rex-home-carousel .thumb{min-height:140px}}
    @media(max-width:480px){#rex-home-carousel{min-height:320px;padding:0.75rem 0}#rex-home-carousel .bk-carousel-wrap{padding:0.5rem}#rex-home-carousel .thumb{min-height:120px}}
    /* *** END CHANGE 3 *** */
  </style>
</head>
<body>

  <header class="rex-header">
    <nav class="rex-nav container">
      <a href="#" class="rex-brand" style="font-weight:700;font-size:18px;text-decoration:none;color:#111">EVERYBODY'S NEWS</a>
      <ul class="rex-menu">
        <li><a href="#">Home</a></li>
        <li><a href="#">About</a></li>
        <li><a href="#">Blog</a></li>
        <li><a href="#">Contact</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <!-- REX: Homepage Carousel (Rex Hero Carousel - Second from top) -->
    <section id="rex-home-carousel" class="container">
      <div class="module-title">
        <div class="main-title"><h2><span>Latest</span> News</h2></div>
      </div>
      <div class="module-breaking-carousel">
        <div class="bk-carousel-wrap">
          <ul class="bk-carousel" id="rex-carousel-list">
            <li class="content_out small-post clearfix"><div class="thumb" aria-hidden="true"></div><div class="post-c-wrap"><h4 class="title"><a href="#">Loading...</a></h4></div></li>
          </ul>
        </div>
      </div>
    </section>

  </main>

  <script>
    // Load Rex Carousel from API
    async function loadRexCarousel() {
      try {
        console.log('Loading Rex Carousel from API...');
        const response = await fetch('/api/rex-carousel', { cache: 'no-store' });
        const data = await response.json();

        if (data.status === 'success' && data.articles && data.articles.length > 0) {
          const carouselList = document.getElementById('rex-carousel-list');
          if (!carouselList) {
            console.error('Rex carousel list element not found');
            return;
          }

          // Clear loading state
          carouselList.innerHTML = '';

          // Create carousel items
          data.articles.forEach(article => {
            const li = document.createElement('li');
            li.className = 'content_out small-post clearfix';

            const imageUrl = article.imageUrl || 'https://via.placeholder.com/300x180/e5e7eb/666?text=News';
            const source = article.source || 'News Source';
            const sourceIcon = article.sourceIcon || '';
            const title = article.title || 'Untitled';
            const link = article.link || '#';
            const pubDate = article.pubDate ? new Date(article.pubDate).toLocaleDateString() : '';

            li.innerHTML = `
              <div class="thumb" aria-hidden="true">
                <img src="${imageUrl}" alt="${title}" loading="lazy">
              </div>
              <div class="post-c-wrap">
                <div class="meta">
                  ${sourceIcon ? `<img src="${sourceIcon}" alt="${source}" class="source-icon">` : ''}
                  <span>${source}</span>
                  ${pubDate ? `<span>•</span><span>${pubDate}</span>` : ''}
                </div>
                <h4 class="title">
                  <a href="${link}" target="_blank" rel="noopener noreferrer">${title}</a>
                </h4>
              </div>
            `;

            carouselList.appendChild(li);
          });

          console.log(`✓ Rex Carousel loaded with ${data.articles.length} articles`);
          console.log(`Sources: RSS (${data.sources?.rss || 0}), MediaStack (${data.sources?.mediastack || 0})`);
        } else {
          console.error('No articles in response:', data);
        }
      } catch (error) {
        console.error('Failed to load Rex Carousel:', error);
      }
    }

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', () => {
      loadRexCarousel();

      // Refresh every 3 minutes
      setInterval(loadRexCarousel, 180000);
    });
  </script>

</body>
</html>
